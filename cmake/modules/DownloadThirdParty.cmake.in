# This cmake script installs ThirdParty stuff downloading them 
project(@TP_PACKAGE_NAME@)
cmake_minimum_required(VERSION 3.1)

# If we don't find Catch2 with the standard find_package, we download it
include(ExternalProject)

find_package(Git)

ExternalProject_Add(
    @TP_PACKAGE_NAME@
    GIT_REPOSITORY @TP_PACKAGE_GIT_REPOSITORY@
    GIT_TAG "master"
    GIT_PROGRESS TRUE 
    UPDATE_COMMAND ${GIT_EXECUTABLE} pull
    LOG_DOWNLOAD ON
    LOG_CONFIGURE ON
    LOG_BUILD ON
    INSTALL_DIR "@TP_PACKAGE_INSTALL_DIR@"
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=<INSTALL_DIR> -DCMAKE_CXX_FLAGS='-g'
)

# Retrieve the path to the cmake scripts for the package
include(GNUInstallDirs)
ExternalProject_Get_property(@TP_PACKAGE_NAME@ INSTALL_DIR)
list(APPEND @TP_PACKAGE_NAME@_CMAKE_MODULE_PATH 
    "${INSTALL_DIR}/${CMAKE_INSTALL_LIBDIR}/cmake"
    "${INSTALL_DIR}/${CMAKE_INSTALL_DATAROOTDIR}/cmake"
)
list(APPEND CMAKE_MODULE_PATH ${@TP_PACKAGE_NAME@_CMAKE_MODULE_PATH})
